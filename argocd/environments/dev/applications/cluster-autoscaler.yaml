apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: cluster-autoscaler
  namespace: argocd
spec:
  project: default
  source:
  - repoURL: https://kubernetes.github.io/autoscaler
    chart: cluster-autoscaler
    targetRevision: 9.29.1
    helm:
        values: |
          autoDiscovery.clusterName: testcluster2
          rbac: 
            serviceAccount:
              # rbac.serviceAccount.annotations -- Additional Service Account annotations.
              annotations:
                eks.amazonaws.com/role-arn: arn:aws:iam::548844171305:role/testcluster2-cluster-autoscaler-role

              # rbac.serviceAccount.create -- If `true` and `rbac.create` is also true, a Service Account will be created.
              create: true
              # rbac.serviceAccount.name -- The name of the ServiceAccount to use. If not set and create is `true`, a name is generated using the fullname template.
              name: "cluster-autoscaler-sa"
              # rbac.serviceAccount.automountServiceAccountToken -- Automount API credentials for a Service Account.
              automountServiceAccountToken: true
  destination:
    server: https://kubernetes.default.svc
    namespace: default
